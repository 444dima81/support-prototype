# Support Prototype ‚Äî AI-–∞–≥–µ–Ω—Ç —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–π –ø–æ–¥–¥–µ—Ä–∂–∫–∏

–ü—Ä–æ—Ç–æ—Ç–∏–ø AI-–∞–≥–µ–Ω—Ç–∞ –¥–ª—è —Å–ª—É–∂–±—ã –ø–æ–¥–¥–µ—Ä–∂–∫–∏ —Å –¥–∏–∞–ª–æ–≥–æ–≤–æ–π –ø–∞–º—è—Ç—å—é, RAG (Qdrant) –∏ –±–∏–∑–Ω–µ—Å-—Å—Ü–µ–Ω–∞—Ä–∏–µ–º **¬´–ù–∞—á–∏—Å–ª–µ–Ω–∏–µ –±–æ–Ω—É—Å–æ–≤ –∫–æ –¥–Ω—é —Ä–æ–∂–¥–µ–Ω–∏—è¬ª**

–ê–≥–µ–Ω—Ç:
- –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ –æ—Å–Ω–æ–≤–µ –±–∞–∑—ã –∑–Ω–∞–Ω–∏–π (RAG)
- –≤–µ–¥—ë—Ç –¥–∏–∞–ª–æ–≥ —Å —É—á—ë—Ç–æ–º –∏—Å—Ç–æ—Ä–∏–∏ –∏ summary
- –≤—ã–ø–æ–ª–Ω—è–µ—Ç —Å—Ü–µ–Ω–∞—Ä–∏–π –î–† **—Ç–æ–ª—å–∫–æ –ø—Ä–∏ —è–≤–Ω–æ–º –∏–Ω—Ç–µ–Ω—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è** –∏ **—Ç–æ–ª—å–∫–æ –Ω–∞ –ø–µ—Ä–≤–æ–º —Å–æ–æ–±—â–µ–Ω–∏–∏ –¥–∏–∞–ª–æ–≥–∞**
- —á–µ—Å—Ç–Ω–æ —Å–æ–æ–±—â–∞–µ—Ç –æ–± –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –∏ –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç —ç—Å–∫–∞–ª–∞—Ü–∏—é
- —Ä–∞–∑–ª–∏—á–∞–µ—Ç –¥–∏–∞–ª–æ–≥–∏ –ø–æ `conversation_id`

---

## üß† –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

- **FastAPI** ‚Äî HTTP API (`POST /chat`)
- **Qdrant** ‚Äî –≤–µ–∫—Ç–æ—Ä–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ
- **Qwen (—á–µ—Ä–µ–∑ OpenAI-compatible API)** ‚Äî LLM –∏ —ç–º–±–µ–¥–¥–∏–Ω–≥–∏
- **In-memory memory** ‚Äî –∏—Å—Ç–æ—Ä–∏—è –¥–∏–∞–ª–æ–≥–∞ + summary
- **RAG** ‚Äî –ø–æ–∏—Å–∫ –ø–æ –±–∞–∑–µ –∑–Ω–∞–Ω–∏–π
- **Scenario Runner** ‚Äî JSON-—Å—Ü–µ–Ω–∞—Ä–∏–π —Å `tool / if / text / end`

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```text
app/
‚îú‚îÄ‚îÄ llm/
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ client.py        # LLM-–∫–ª–∏–µ–Ω—Ç (Qwen3)
‚îÇ   ‚îî‚îÄ‚îÄ embeddings.py    # –ö–ª–∏–µ–Ω—Ç –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤
‚îÇ
‚îú‚îÄ‚îÄ parser/
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ kb_html.py       # –ü–∞—Ä—Å–∏–Ω–≥ HTML-—Ñ–∞–π–ª–∞ –±–∞–∑—ã –∑–Ω–∞–Ω–∏–π
‚îÇ   ‚îî‚îÄ‚îÄ chunker.py       # –†–∞–∑–±–∏–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –Ω–∞ —á–∞–Ω–∫–∏
‚îÇ
‚îú‚îÄ‚îÄ rag/
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ retriever.py     # –ü–æ–∏—Å–∫ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã—Ö —á–∞–Ω–∫–æ–≤ –≤ Qdrant
‚îÇ   ‚îî‚îÄ‚îÄ answer.py        # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç–≤–µ—Ç–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ —á–∞–Ω–∫–æ–≤ –∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
‚îÇ
‚îú‚îÄ‚îÄ scenario/
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ runner.py        # –î–≤–∏–∂–æ–∫ —Å—Ü–µ–Ω–∞—Ä–∏—è ¬´–ù–∞—á–∏—Å–ª–µ–Ω–∏–µ –±–æ–Ω—É—Å–æ–≤ –∫–æ –¥–Ω—é —Ä–æ–∂–¥–µ–Ω–∏—è¬ª
‚îÇ   ‚îî‚îÄ‚îÄ tools.py         # Tools (get_user_data ‚Äî stub)
‚îÇ
‚îú‚îÄ‚îÄ main.py              # FastAPI-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏ endpoint POST /chat
‚îî‚îÄ‚îÄ memory.py            # In-memory –ø–∞–º—è—Ç—å –¥–∏–∞–ª–æ–≥–∞ –∏ summary
‚îÇ
data/
‚îî‚îÄ‚îÄ test.html             # –ü—Ä–∏–º–µ—Ä –±–∞–∑—ã –∑–Ω–∞–Ω–∏–π (HTML)
‚îÇ
scripts/
‚îî‚îÄ‚îÄ export_kb_chunks.py  # –£—Ç–∏–ª–∏—Ç–∞ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —á–∞–Ω–∫–æ–≤ (—á–∞—Å—Ç—å –ø–∞–π–ø–ª–∞–π–Ω–∞ RAG)
```
---

## ‚öôÔ∏è –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Python 3.10+
- Docker + docker-compose
- API KEY(llm + embeddings)

---

## üîê –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

–°–æ–∑–¥–∞–π —Ñ–∞–π–ª `.env` –∏ –∑–∞–ø–æ–ª–Ω–∏ –∑–Ω–∞—á–µ–Ω–∏—è

**–í–∞–∂–Ω–æ:** –ø—Ä–æ–µ–∫—Ç –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç —Å–µ–∫—Ä–µ—Ç–æ–≤. –î–ª—è —Ä–∞–±–æ—Ç—ã –Ω—É–∂–µ–Ω API-–∫–ª—é—á LLM - —É–∫–∞–∑—ã–≤–∞–π—Ç–µ —Å–≤–æ–π –∫–ª—é—á –≤ `.env`

–ü—Ä–∏–º–µ—Ä `.env`:

```env
API_KEY=your_api_key
OPENAI_BASE_URL=https://foundation-models.api.cloud.ru/v1
QWEN_CHAT_MODEL=Qwen/Qwen3-Coder-480B-A35B-Instruct
QWEN_EMBED_MODEL=Qwen/Qwen3-Embedding-0.6B

QDRANT_URL=http://localhost:6333
QDRANT_COLLECTION=kb
```
## üóÑ –ó–∞–ø—É—Å–∫ Qdrant
–î–ª—è —Ä–∞–±–æ—Ç—ã RAG —Ç—Ä–µ–±—É–µ—Ç—Å—è –∑–∞–ø—É—â–µ–Ω–Ω–æ–µ –≤–µ–∫—Ç–æ—Ä–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ Qdrant
–ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ docker-compose:

```bash
# start
docker compose up -d

# test
`curl http://localhost:6333/healthz`
```
## –ò–Ω–¥–µ–∫—Å–∞—Ü–∏—è –±–∞–∑—ã –∑–Ω–∞–Ω–∏–π (RAG)
```python
python -m scripts.export_kb_parsed # –ü–∞—Ä—Å–∏–Ω–≥ HTML-–¥–æ–∫—É–º–µ–Ω—Ç–∞ –±–∞–∑—ã –∑–Ω–∞–Ω–∏–π
python -m scripts.export_kb_chunks # –†–∞–∑–±–∏–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –Ω–∞ —á–∞–Ω–∫–∏
python -m scripts.export_kb_vectors # –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤
python -m scripts.ingest_qdrant # –ó–∞–≥—Ä—É–∑–∫–∞ –≤ Qdrant
```

## –ó–∞–ø—É—Å–∫ API
`uvicorn app.main:app --reload`

–∞–¥—Ä–µ—Å –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
`http://localhost:8000`

## –ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞
```bash
curl -X POST http://localhost:8000/chat \
  -H "Content-Type: application/json" \
  -d '{"conversation_id":"c1","message":"–ü–æ–¥—Å–∫–∞–∂–∏—Ç–µ –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, –µ—Å—Ç—å –ª–∏ —É –º–µ–Ω—è –∞–Ω–Ω—É–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —á–µ–∫–∏?"}' | jq
```
## –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

–ù–∏–∂–µ –ø—Ä–∏–≤–µ–¥–µ–Ω—ã —Å–∫—Ä–∏–Ω—à–æ—Ç—ã –ª–æ–≥–æ–≤ –∏ –æ—Ç–≤–µ—Ç–æ–≤ API, –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É—é—â–∏–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—É—é —Ä–∞–±–æ—Ç—É –∞–≥–µ–Ω—Ç–∞ –≤ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏—è—Ö, –≤–∫–ª—é—á–∞—è –≥—Ä–∞–Ω–∏—á–Ω—ã–µ —Å–ª—É—á–∞–∏

### üîπ –û–±—ã—á–Ω—ã–π RAG-–∑–∞–ø—Ä–æ—Å
![RAG test](img/rag_test.png)

–û—Ç–≤–µ—Ç —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è —Å—Ç—Ä–æ–≥–æ –Ω–∞ –æ—Å–Ω–æ–≤–µ –±–∞–∑—ã –∑–Ω–∞–Ω–∏–π –±–µ–∑ –∑–∞–ø—É—Å–∫–∞ —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤

---

### üîπ –°—Ü–µ–Ω–∞—Ä–∏–π ¬´–î–µ–Ω—å —Ä–æ–∂–¥–µ–Ω–∏—è¬ª 
![Birthday test](img/hb_test.png)

–°—Ü–µ–Ω–∞—Ä–∏–π –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –Ω–∞ –ø–µ—Ä–≤–æ–º —Å–æ–æ–±—â–µ–Ω–∏–∏: –æ–±—Ä–∞—â–µ–Ω–∏–µ –ø–æ –∏–º–µ–Ω–∏, –ø–æ–∑–¥—Ä–∞–≤–ª–µ–Ω–∏–µ –∏ –Ω–∞—á–∏—Å–ª–µ–Ω–∏–µ –±–æ–Ω—É—Å–æ–≤ + –æ—Ç–≤–µ—Ç –ø–æ RAG

---

### üîπ –ù–∞–º–µ–∫ –Ω–∞ –î–µ–Ω—å —Ä–æ–∂–¥–µ–Ω–∏–µ
![Question birthday test](img/Qq_hb_test.png)

–ê–≥–µ–Ω—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Ä–∞—Å–ø–æ–∑–Ω–∞—ë—Ç –∏–Ω—Ç–µ–Ω—Ç –¥–Ω—è —Ä–æ–∂–¥–µ–Ω–∏—è –¥–∞–∂–µ –≤ –Ω–µ—è–≤–Ω–æ–π —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–µ

---

### üîπ –õ–æ–∂–Ω—ã–π –∏–Ω—Ç–µ–Ω—Ç –¥–Ω—è —Ä–æ–∂–¥–µ–Ω–∏—è
![Fake birthday test](img/fake_hb_test.png)

–ê–≥–µ–Ω –ø–æ–Ω–∏–º–∞–µ—Ç —á—Ç–æ –Ω–µ —Å–µ–≥–æ–¥–Ω—è

---

### üîπ –î–µ–Ω—å —Ä–æ–∂–¥–µ–Ω–∏—è –Ω–µ —Å–µ–≥–æ–¥–Ω—è
![Birthday yesterday test](img/hb_yest_test.png)

–ê–≥–µ–Ω—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Å–∏—Ç—É–∞—Ü–∏—é, –∫–æ–≥–¥–∞ –¥–µ–Ω—å —Ä–æ–∂–¥–µ–Ω–∏—è –±—ã–ª –Ω–µ —Å–µ–≥–æ–¥–Ω—è ‚Äî –±–æ–Ω—É—Å—ã –Ω–µ –Ω–∞—á–∏—Å–ª—è—é—Ç—Å—è

---

### üîπ Trivial-—Å–æ–æ–±—â–µ–Ω–∏–µ
![Just OK test](img/just_ok_test.png)

–ö–æ—Ä–æ—Ç–∫–∏–π UX-–æ—Ç–≤–µ—Ç –±–µ–∑ –∑–∞–ø—É—Å–∫–∞ RAG –∏ —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤

---

### üîπ –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–∞–º—è—Ç–∏ –¥–∏–∞–ª–æ–≥–∞ (summary)
![Memory test](img/memroy_test.png)

–ê–≥–µ–Ω—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∫—Ä–∞—Ç–∫–æ–µ —Ä–µ–∑—é–º–µ –¥–∏–∞–ª–æ–≥–∞ –ø–æ –∑–∞–ø—Ä–æ—Å—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

---

### üîπ –ú–µ—Ç–∞-–≤–æ–ø—Ä–æ—Å (¬´–ö—Ç–æ —Ç—ã?¬ª)
![Meta test](img/meta_test.png)

–ú–µ—Ç–∞-–∏–Ω—Ç–µ–Ω—Ç—ã –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –±–µ–∑ –æ–±—Ä–∞—â–µ–Ω–∏—è –∫ RAG –∏ —Å—Ü–µ–Ω–∞—Ä–∏—è–º

---

### üîπ –û–±—â–∏–π –∑–∞–ø—Ä–æ—Å
![Non-type test](img/non_type_test.png)

–ê–≥–µ–Ω—Ç –≤–∏–¥–∏—Ç –æ–±—â–∏–µ –∏ –Ω–µ—Ç–æ—á–Ω—ã–µ —Ç–µ–º—ã

---

### üîπ –°—Ç—Ä–µ—Å—Å-—Ç–µ—Å—Ç –ø—É—Å—Ç–æ—Ç–æ–π
![Stress test](img/stress_test.png)

–°–µ—Ä–≤–∏—Å —É—Å—Ç–æ–π—á–∏–≤–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç

---

### üîπ –°—Ç—Ä–µ—Å—Å-—Ç–µ—Å—Ç 2
![Stress test 2](img/stress_test2.png)

–°–µ—Ä–≤–∏—Å —É—Å—Ç–æ–π—á–∏–≤–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –¥–ª–∏–Ω–Ω—ã–µ –∏ —à—É–º–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –±–µ–∑ –æ—à–∏–±–æ–∫
